# Offline-First proof of concept

Based on this paper (https://www2.realm.io/whitepaper/offline-first-success) wrote by the Realm Team, there are three options in order to implement the offline-first approach:
- Caching: it consists on copy the most recent data of the API locally. It’s fast, but the principal disadvantage is that this strategy is effective only for read-only purposes.
- Manual replication: this custom coded approach takes a step beyond caching to give read and write ability to the mobile client. It allows users to manipulate data while offline by marking objects as changed. When a connection becomes available, all changed objects are sent in full by triggering a push and pull operation that pulls the changed objects from the server and pushes the changed objects from the device. We need something like a Helper class called SyncDataEngine and two methods: PushAllAsync() and PullAllAsync(), that must be executed when the phone connects to the internet.
- Realtime datasync by platform: In this model, data sync is not manual, but automatic, sending changes in realtime. A highly efficient data synchronization protocol passes only the marginal changes in compressed binary format between device and server-side layer. Further, rather than sending complete objects, devoid of what specifically changed, this model focuses on synchronizing the specific operations along with the data. This additional information captures exactly what the user intended, allowing the system to automatically resolve conflicts, leading to predictable synchronization without manual intervention that impedes performance. This is the best approach, and Realm has a built-in implementation for this. Note: it’s a paid service.

In this proof of concept, the third approach is taken. The example consists in three independent projects:
- offline-first-poc: it’s the Realm Server. It has the real-time database. It’s developed with Node.js.
- OfflineFirstPOC: it’s a Xamarin app available in Android and iOS. It takes the shared project strategy. The app has a list of books and consists in a basic CRUD: add book, edit book, delete book. Every change impacts on the database.
- OfflineFirstPOCAPI: it’s a .NET Core app that is connected to the Realm Server. Every change made in the Realm database (in our case, made by the mobile application) is listened by the API. It executes HandleChangeAsync(), that has a parameter of type IChangeDetails. On this object, you can find the CurrentRealm and the PreviousRealm and compare in order to update the API database.